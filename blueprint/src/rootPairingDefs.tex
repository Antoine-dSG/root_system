\chapter{Root pairing}
\label{cha:root-pairing}
\section{Basic definitions}
\label{sec:basic-definitions}

We follow the outline of mathlib's definitions. 

\begin{definition}
    \label{def:perfect-pairing}
    \leanok
    A {\it perfect pairing} is a quadruple $(R,M,N,\mathcal{L})$ where $R$ is a commutative ring, $M,N$ are 
    $R$-modules, and $\mathcal{L} : M \times N \to R$ is an $R$-bilinear map such that the induced maps
    \[
        \mathcal{L}_M : M \to {\rm Hom}_R(N,R), \quad m \mapsto \mathcal{L}(m,-),
    \]
    and 
    \[
        \mathcal{L}_N : N \to {\rm Hom}_R(M,R), \quad n \mapsto \mathcal{L}(-,n),
    \]
    are isomorphisms of $R$-modules.
\end{definition}

This leads to the very general notion of a root pairing.
\begin{definition}
    \label{def:root-pairing}
    \uses{def:perfect-pairing}
    \leanok
    A {\it root pairing} is a tuple $(R,M,N,\mathcal{L},I,\alpha, \alpha^\vee,s)$ with
       \begin{enumerate} 
        \item $(R,M,N,\mathcal{L})$ is a perfect pairing,
        \item  $I$ is a set (called the {\it index set}),
        \item $\alpha : I \to M, i \mapsto \alpha_i$ is an injective map on sets,
        \item $\alpha^\vee : I \to N, i \mapsto \alpha_i^\vee$ is an injective map on sets,
        \item $s : I \to {\rm Bij}(I,I)$, i.e. for each $i \in I$, $s_i \stackrel{\text{denotes}}{=}s(i)$ is a bijection on $I$,
       \end{enumerate}
       subject to the following conditions:\\
       I) For all $i \in I$, $\mathcal{L}(\alpha_i,\alpha^\vee_i) = 2$. \\
       II) For all $i,j \in I$, we have
            \begin{align*}
            \alpha_{s_i(j)} &= \alpha_j - \mathcal{L}(\alpha_j,\alpha^\vee_i)\alpha_i \\
            \alpha_{s_i(j)}^\vee &= \alpha_j^\vee - \mathcal{L}(\alpha_i,\alpha^\vee_j)\alpha_i^\vee
            \end{align*}
\end{definition}

{\it Lean implementation note: A root pairing is defined in Mathlib as a {\it structure}. A structure is a non-recursive inductive 
type that contains only one constructor. It is also sometimes called a {\it record}. Formally, one can construct a structure using either
the ''inductive'' (with only one constructor, and including field names) or the ''structure'' keyword. The latter is more convenient for defining a structure,
since Lean automatically generates the projection functions for each field. If the constructor name is not provided when defining a structure, then a 
constructor is named ``mk" by default.}

Elements of $\Phi := {\rm Im}(\alpha)$ and $\Phi^\vee := {\rm Im}(\alpha^\vee)$ are called {\it roots} and {\it coroots}, 
respectively, of the root pairing $\mathcal{R}$. 

\textsc{Is it true that condition I is equivalent to $s_i^2 = id$ for all $i \in I$?}

\begin{remark}
    \label{def:dual-root-pairing}
    \leanok
    \uses{def:root-pairing}
It is straightforward to see that if $\mathcal{R} := (R,M,N,\mathcal{L},I,\alpha, \alpha^\vee,s)$ is 
a root pairing then $\mathcal{R}^\vee := (R,N,M,\mathcal{L}^\vee,I,\alpha^\vee, \alpha,s)$ is again 
a root pairing, where $\mathcal{L}^\vee (n,m) := \mathcal{L}(m,n)$ for all $n \in N,m \in M$. The 
latter is called the {\it Langlands dual} of $\mathcal{R}$.
\end{remark}

\begin{definition}
    \label{def:root-datum}
    \leanok
    \uses{def:root-pairing}
     A root pairing $(R,M,N,\mathcal{L},I,\alpha, \alpha^\vee,s)$ is called a {\it root datum} if 
    i) $R = \mathbb{Z}$; and ii) $M,N$ are finitely generated free $\mathbb{Z}$-modules (i.e. free abelian groups).  
\end{definition}

{\it Lean implementation note: A root datum is defined in Mathlib as an abbreviation of 
a root pairing with $R = \mathbb{Z}$ and $M,N$ finitely generated free $\mathbb{Z}$-modules. Here 
recall that the syntax for defining an abbreviation is ``abbrev Name : Type := Definition"}

\begin{definition}
    \label{def:root-system}
    \leanok
    \uses{def:root-pairing}
    A root pairing $(R,M,N,\mathcal{L},I,\alpha, \alpha^\vee,s)$ is called a {\it root system} if
    \[
        {\rm span}_R \Phi = M \quad \text{and} \quad {\rm span}_R \Phi^\vee = N.
    \] 
\end{definition}

\begin{itemize}
    \item Need to add: Comment or proof that when $R = \mathbb{Q}$, we recover the definitions in Bourbaki.
\end{itemize}

Let us fix a root pairing $\mathcal{R} = (R,M,N,\mathcal{L},I,\alpha, \alpha^\vee,s)$. We will now 
explain how to lift $s$ to the module level. Consider $\sigma: I \to {\rm End}_R(M)$ and 
$\sigma^\vee : I \to {\rm End}_R(N)$ defined by

TBC

Remaining concepts to be added:
\begin{enumerate}
    \item Values of the root pairing and crystallographic root pairings
    \item Coxeter weights
    \item Orthogonal roots 
    \item Irreducible root pairings
    \item Reduced root pairings
    \item Rank of a root datum 
\end{enumerate}